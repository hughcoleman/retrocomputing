C     THIS IMPLEMENTS A BASIC ITERATIVE ALGORITHM TO FIND THE PRIME
C     FACTORS OF A GIVEN INTEGER N.

 10   FORMAT ( 1I5 )
 11   FORMAT ( 18H FACTORIZATION OF 1I5 )

C     GET THE QUERIED INTEGER FROM STANDARD INPUT, IF IT IS ONE OR LESS
C     EXIT THE PROGRAM.
 20   READ 10, N
      IF (N - 1) 9999, 9999, 21
 21   PRINT 11, N

C     DIVIDE OUT AS MANY FACTORS OF TWO AS POSSIBLE
      IFAC = 2
 30   IF (XMODF(N, IFAC)) 9999, 31, 40
 31   N = N / 2
      I = 2
      PRINT 10, I
      GOTO 30

C     DIVIDE OUT ODD INTEGERS FROM 3 TO SQRT(N).
 40   DO 50 IFAC = 3, 32767, 2
C         CHECK IF IFAC SQUARED EXCEEDS N
          IF (IFAC**2 - N) 41, 41, 60
 41       IF (XMODF(N, IFAC)) 9999, 42, 50 
 42       N = N / IFAC
          PRINT 10, IFAC
          GOTO 41
 50   CONTINUE
 
C     IF N IS STILL GREATER THAN ONE, THEN N IS ALSO A PRIME FACTOR.
 60   IF (N-1) 70, 70, 61 
 61   PRINT 10, N

 70   GOTO 20

 9999 STOP
